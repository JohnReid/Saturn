#!/bin/bash -e
#
# Summarise DNase bigwig file by regions
#

#
# Parse arguments
#
USAGE="USAGE: $0 <cell>"
CELL=${1:?$USAGE}

#
# Set up variables
#
ANNOTATIONS=$SATURNDIR/Data/annotations
BED=$ANNOTATIONS/ladder_regions.blacklistfiltered.bed
BW=$SATURNDIR/Data/DNASE/fold_coverage_wiggles/DNASE.$CELL.fc.signal.bigwig
OUTPUTDIR=$SATURNDIR/Features/DNase/
OUTPUT=$OUTPUTDIR/DNase-$CELL-bw-summary.tab

#
# Check files
#
if [ ! -s $BED ]
then
    echo "BED does not exist: $BED"
    exit -1
fi
if [ ! -s $BW ]
then
    echo "BigWig does not exist: $BW"
    exit -1
fi
[ -d $OUTPUTDIR ] || mkdir -p $OUTPUTDIR

#
# Run average
#
bigWigAverageOverBed $BW $BED $OUTPUT
